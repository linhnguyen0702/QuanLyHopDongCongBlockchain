# ğŸš€ Há»‡ thá»‘ng Quáº£n lÃ½ Há»£p Ä‘á»“ng CÃ´ng vá»›i Ethereum Blockchain

Há»‡ thá»‘ng quáº£n lÃ½ há»£p Ä‘á»“ng cÃ´ng tÃ­ch há»£p Ethereum Blockchain (Sepolia Testnet) vá»›i **User Wallet Signing** - ngÆ°á»i dÃ¹ng kÃ½ transaction trá»±c tiáº¿p qua MetaMask Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh minh báº¡ch, báº¥t biáº¿n vÃ  cÃ³ thá»ƒ kiá»ƒm chá»©ng.

## ğŸ“‹ Má»¥c lá»¥c

- [Tá»•ng quan](#-tá»•ng-quan)
- [CÃ´ng nghá»‡ sá»­ dá»¥ng](#-cÃ´ng-nghá»‡-sá»­-dá»¥ng)
- [Kiáº¿n trÃºc Blockchain](#-kiáº¿n-trÃºc-blockchain)
- [Cáº¥u trÃºc dá»± Ã¡n](#-cáº¥u-trÃºc-dá»±-Ã¡n)
- [YÃªu cáº§u há»‡ thá»‘ng](#-yÃªu-cáº§u-há»‡-thá»‘ng)
- [CÃ i Ä‘áº·t nhanh](#-cÃ i-Ä‘áº·t-nhanh)
- [HÆ°á»›ng dáº«n chi tiáº¿t](#-hÆ°á»›ng-dáº«n-chi-tiáº¿t)
- [Cháº¡y dá»± Ã¡n](#-cháº¡y-dá»±-Ã¡n)
- [TÃ­nh nÄƒng](#-tÃ­nh-nÄƒng)
- [User Wallet Signing](#-user-wallet-signing)
- [API Documentation](#-api-documentation)
- [Troubleshooting](#-troubleshooting)
- [Báº£o máº­t](#-báº£o-máº­t)
- [Scripts há»¯u Ã­ch](#-scripts-há»¯u-Ã­ch)

---

## ğŸ¯ Tá»•ng quan

Dá»± Ã¡n bao gá»“m 3 pháº§n chÃ­nh:

1. **Frontend** - React 18.2 application vá»›i Material-UI
2. **Backend** - Node.js/Express API server vá»›i MongoDB
3. **Blockchain** - Ethereum Smart Contract trÃªn Sepolia Testnet

### â­ Äiá»ƒm ná»•i báº­t:

- âœ… **User Wallet Signing** - NgÆ°á»i dÃ¹ng kÃ½ transaction trá»±c tiáº¿p qua MetaMask
- âœ… **Gasless cho Admin** - Chá»‰ cáº§n gas khi approve/reject
- âœ… **Multi-Approval Workflow** - PhÃª duyá»‡t 2 cáº¥p vá»›i blockchain tracking
- âœ… **MetaMask Activity Integration** - Xem táº¥t cáº£ transactions trong vÃ­
- âœ… **Authorization System** - Admin cÃ³ thá»ƒ authorize thÃªm wallet addresses
- âœ… **Smart Contract Verification** - Contract Ä‘Ã£ verify trÃªn Etherscan
- âœ… **Immutable Audit Trail** - Lá»‹ch sá»­ thay Ä‘á»•i khÃ´ng thá»ƒ xÃ³a trÃªn blockchain

### TÃ­nh nÄƒng chÃ­nh:

- ğŸ“ Quáº£n lÃ½ há»£p Ä‘á»“ng cÃ´ng (CRUD) vá»›i blockchain recording
- ğŸ‘· Quáº£n lÃ½ nhÃ  tháº§u vÃ  thÃ´ng tin liÃªn quan
- âœ… PhÃª duyá»‡t há»£p Ä‘á»“ng 2 cáº¥p (Manager & Admin)
- ğŸ“Š Dashboard vÃ  bÃ¡o cÃ¡o thá»‘ng kÃª
- ğŸ” Audit trail chi tiáº¿t vá»›i blockchain verification
- ğŸ”— **Blockchain integration** - Má»—i há»£p Ä‘á»“ng ghi lÃªn Ethereum
- ğŸ¦Š **MetaMask integration** - Popup confirmation cho má»i transaction
- ğŸ“ˆ **Transaction tracking** - Xem chi tiáº¿t trÃªn Etherscan

---

## ğŸ› ï¸ CÃ´ng nghá»‡ sá»­ dá»¥ng

### Frontend:

- **React** 18.2.0 - UI framework
- **Material-UI** 5.14 - Component library
- **React Router** 6.20 - Routing
- **React Query** 3.39 - Data fetching & caching
- **Ethers.js** 6.15 - Ethereum library cho user wallet signing
- **Formik** & **Yup** - Form validation
- **React Hot Toast** - Notifications
- **Recharts** - Data visualization
- **i18next** - Internationalization (VI/EN)

### Backend:

- **Node.js** & **Express** 4.18 - Server framework
- **MongoDB** & **Mongoose** 8.0 - Database
- **JWT** - Authentication & Authorization
- **Ethers.js** 6.10 - Blockchain integration (backup)
- **Bcrypt.js** - Password hashing
- **Joi** - Request validation
- **Multer** - File upload handling
- **Winston** & **Morgan** - Logging
- **Helmet** - Security headers
- **Express Rate Limit** - API protection
- **Nodemailer** - Email notifications

### Blockchain:

- **Solidity** 0.8.20 - Smart contract language
- **Hardhat** 2.19 - Development environment
- **OpenZeppelin** 5.0 - Secure contract libraries
- **Ethereum Sepolia Testnet** - Test network
- **Alchemy** - RPC provider
- **Etherscan** - Block explorer

---

## â›“ï¸ Kiáº¿n trÃºc Blockchain

### ğŸ¯ User Wallet Signing Architecture

KhÃ¡c vá»›i há»‡ thá»‘ng truyá»n thá»‘ng sá»­ dá»¥ng backend wallet, há»‡ thá»‘ng nÃ y sá»­ dá»¥ng **User Wallet Signing**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser   â”‚â”€â”€â”€â”€â–¶â”‚   MetaMask   â”‚â”€â”€â”€â”€â–¶â”‚  Ethereum   â”‚
â”‚   (React)   â”‚â—€â”€â”€â”€â”€â”‚   Wallet     â”‚â—€â”€â”€â”€â”€â”‚  Network    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚                     â”‚
       â”‚               User signs                 â”‚
       â”‚               transaction                â”‚
       â”‚                    â”‚                     â”‚
       â–¼                    â–¼                     â–¼
  Frontend          MetaMask Popup        Sepolia Testnet
  - Prepare tx      - Show details        - Execute tx
  - Call service    - User confirm        - Record on chain
  - Handle result   - Pay gas fee         - Return tx hash
```

### ï¿½ Key Differences vs Backend Signing:

| Feature                      | Backend Signing âŒ    | User Wallet Signing âœ…           |
| ---------------------------- | --------------------- | -------------------------------- |
| **Gas Payer**                | Backend wallet        | User wallet (transparent)        |
| **MetaMask Popup**           | No                    | Yes (every transaction)          |
| **MetaMask Activity**        | Not visible           | Fully visible                    |
| **Transaction Control**      | Backend controls      | User controls                    |
| **Transparency**             | Low (hidden)          | High (user sees everything)      |
| **Security**                 | Backend key exposure  | User controls private key        |
| **Audit Trail**              | Backend only          | User wallet + blockchain         |
| **Multi-user approval flow** | Easy                  | Requires authorization system âœ… |

### ğŸ“Š Flow diagram:

### ğŸ“Š Flow diagram:

**1. Táº¡o Há»£p Äá»“ng (Create Contract):**
```
User â†’ Fill Form â†’ Click Submit
  â†“
MetaMask Popup (User signs & pays gas)
  â†“
Transaction â†’ Sepolia Network
  â†“
Save to MongoDB with tx hash
  â†“
Visible in MetaMask Activity âœ…
```

**2. PhÃª Duyá»‡t 2 Cáº¥p (Two-Level Approval):**
```
Manager Approval #1:
  â†’ Save to MongoDB only (no blockchain)
  â†’ No MetaMask popup
  â†’ Fast response

Admin Approval #2:
  â†’ MetaMask popup appears
  â†’ User signs transaction
  â†’ Contract status: pending â†’ approved
  â†’ Transaction visible in Activity âœ…
```

### ğŸ—ï¸ Smart Contract Details:

- **Contract Address**: `0xa6315fC859Bc66C7D8269eE4FA2a3e7ada2ae39f`
- **Network**: Sepolia Testnet (Chain ID: 11155111)
- **Verified on Etherscan**: âœ… Yes
- **Owner**: Backend wallet (authorized)
- **Authorization**: Multi-user support via `authorizeUser()` function

**Key Functions:**
- `createContract()` - Create new contract (authorized users)
- `updateContract()` - Update existing contract (authorized users)
- `approveContract()` - Approve contract (authorized users)
- `rejectContract()` - Reject contract (authorized users)
- `authorizeUser()` - Add/remove authorized addresses (owner only)
- `getContract()` - Read contract data (public)

---

## ğŸ“ Cáº¥u trÃºc dá»± Ã¡n

```
QuanLyHopDongCong/
â”œâ”€â”€ backend/                      # Node.js Backend API
â”‚   â”œâ”€â”€ models/                   # MongoDB Schemas
â”‚   â”‚   â”œâ”€â”€ Contract.js           # Contract model
â”‚   â”‚   â”œâ”€â”€ Contractor.js         # Contractor model
â”‚   â”‚   â”œâ”€â”€ User.js               # User & authentication
â”‚   â”‚   â”œâ”€â”€ AuditLog.js           # Audit trail
â”‚   â”‚   â””â”€â”€ SystemSettings.js     # System configuration
â”‚   â”œâ”€â”€ routes/                   # API Endpoints
â”‚   â”‚   â”œâ”€â”€ auth.js               # Authentication
â”‚   â”‚   â”œâ”€â”€ contracts.js          # Contract CRUD
â”‚   â”‚   â”œâ”€â”€ contractors.js        # Contractor management
â”‚   â”‚   â”œâ”€â”€ users.js              # User management
â”‚   â”‚   â”œâ”€â”€ reports.js            # Statistics & reports
â”‚   â”‚   â”œâ”€â”€ audit.js              # Audit logs
â”‚   â”‚   â””â”€â”€ settings.js           # System settings
â”‚   â”œâ”€â”€ services/                 # Business Logic
â”‚   â”‚   â”œâ”€â”€ blockchainService.js  # Backend blockchain (backup)
â”‚   â”‚   â””â”€â”€ emailService.js       # Email notifications
â”‚   â”œâ”€â”€ middleware/               # Express Middleware
â”‚   â”‚   â”œâ”€â”€ auth.js               # JWT verification
â”‚   â”‚   â””â”€â”€ validation.js         # Request validation
â”‚   â”œâ”€â”€ blockchain/               # Contract ABIs
â”‚   â”‚   â””â”€â”€ ContractManager.json  # Smart contract ABI
â”‚   â”œâ”€â”€ uploads/                  # File storage
â”‚   â”‚   â””â”€â”€ avatars/              # User avatars
â”‚   â”œâ”€â”€ config.env                # Environment variables âš ï¸
â”‚   â”œâ”€â”€ config.env.example        # Example config
â”‚   â”œâ”€â”€ server.js                 # Application entry point
â”‚   â”œâ”€â”€ package.json              # Dependencies
â”‚   â”œâ”€â”€ seed-all.js               # Database seeding
â”‚   â””â”€â”€ clear-all.js              # Database cleanup
â”‚
â”œâ”€â”€ frontend/                     # React Frontend Application
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ index.html            # HTML template
â”‚   â”‚   â””â”€â”€ locales/              # i18n translations
â”‚   â”‚       â”œâ”€â”€ en/               # English
â”‚   â”‚       â””â”€â”€ vi/               # Vietnamese
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/           # Reusable Components
â”‚   â”‚   â”‚   â”œâ”€â”€ Common/           # Shared components
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoadingSpinner.js
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BlockchainProgressNotification.js
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout/           # Layout components
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Layout.js     # Main layout with sidebar
â”‚   â”‚   â”‚   â””â”€â”€ Blockchain/       # Blockchain components
â”‚   â”‚   â”‚       â”œâ”€â”€ BlockchainInfo.js    # Contract info
â”‚   â”‚   â”‚       â””â”€â”€ WalletConnect.js     # Wallet connection
â”‚   â”‚   â”œâ”€â”€ contexts/             # React Contexts
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.js    # Authentication state
â”‚   â”‚   â”‚   â”œâ”€â”€ BlockchainContext.js    # Wallet connection
â”‚   â”‚   â”‚   â””â”€â”€ SettingsContext.js      # App settings
â”‚   â”‚   â”œâ”€â”€ pages/                # Page Components
â”‚   â”‚   â”‚   â”œâ”€â”€ Auth/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Login.js      # Login page
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Dashboard.js  # Main dashboard
â”‚   â”‚   â”‚   â”œâ”€â”€ Contracts/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Contracts.js          # List contracts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CreateContract.js     # Create (MetaMask âœ…)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EditContract.js       # Edit (MetaMask âœ…)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ContractDetail.js     # View details
â”‚   â”‚   â”‚   â”œâ”€â”€ Contractors/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Contractors.js        # List contractors
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CreateContractor.js   # Create contractor
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ContractorDetail.js   # View details
â”‚   â”‚   â”‚   â”œâ”€â”€ Approval/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Approval.js   # Approve/Reject (MetaMask âœ…)
â”‚   â”‚   â”‚   â”œâ”€â”€ Users/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Users.js      # User management
â”‚   â”‚   â”‚   â”œâ”€â”€ Reports/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Reports.js    # Reports & statistics
â”‚   â”‚   â”‚   â”œâ”€â”€ Audit/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Audit.js      # Audit trail
â”‚   â”‚   â”‚   â”œâ”€â”€ Security/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Security.js   # Security settings
â”‚   â”‚   â”‚   â””â”€â”€ Profile/
â”‚   â”‚   â”‚       â””â”€â”€ Profile.js    # User profile
â”‚   â”‚   â”œâ”€â”€ services/             # API & Blockchain Services
â”‚   â”‚   â”‚   â”œâ”€â”€ api.js            # Axios API client
â”‚   â”‚   â”‚   â”œâ”€â”€ userBlockchainService.js  # ğŸ”‘ User wallet signing
â”‚   â”‚   â”‚   â””â”€â”€ ContractManager.json      # Contract ABI
â”‚   â”‚   â”œâ”€â”€ App.js                # Main App component
â”‚   â”‚   â”œâ”€â”€ index.js              # React entry point
â”‚   â”‚   â”œâ”€â”€ theme.js              # MUI theme config
â”‚   â”‚   â””â”€â”€ i18n.js               # i18next config
â”‚   â””â”€â”€ package.json              # Frontend dependencies
â”‚
â”œâ”€â”€ blockchain/                   # Ethereum Smart Contracts
â”‚   â”œâ”€â”€ contracts/
â”‚   â”‚   â””â”€â”€ ContractManager.sol   # Main smart contract
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ deploy.js             # Deployment script
â”‚   â”‚   â”œâ”€â”€ check-balance.js      # Check wallet balance
â”‚   â”‚   â””â”€â”€ authorize-user.js     # ğŸ”‘ Authorize wallet addresses
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â””â”€â”€ ContractManager.test.js    # Contract tests
â”‚   â”œâ”€â”€ abi/                      # Compiled contract ABIs
â”‚   â”‚   â””â”€â”€ ContractManager.json  # Latest ABI
â”‚   â”œâ”€â”€ deployments/              # Deployment records
â”‚   â”‚   â””â”€â”€ sepolia_*.json        # Deployment history
â”‚   â”œâ”€â”€ artifacts/                # Hardhat compilation output
â”‚   â”œâ”€â”€ hardhat.config.js         # Hardhat configuration
â”‚   â””â”€â”€ package.json              # Blockchain dependencies
â”‚
â”œâ”€â”€ docs/                         # Documentation
â”‚   â”œâ”€â”€ README_BLOCKCHAIN.md      # Blockchain docs
â”‚   â”œâ”€â”€ BLOCKCHAIN_SETUP.md       # Setup guide
â”‚   â”œâ”€â”€ QUICK_START.md            # Quick start guide
â”‚   â”œâ”€â”€ EMAIL_SETUP_GUIDE.md      # Email config
â”‚   â””â”€â”€ BEGINNER_GUIDE.md         # Beginner guide
â”‚
â”œâ”€â”€ scripts/                      # Utility scripts
â”‚   â”œâ”€â”€ start-all.bat             # Start backend + frontend
â”‚   â”œâ”€â”€ stop-all.bat              # Stop all processes
â”‚   â””â”€â”€ setup-blockchain.bat      # Blockchain setup
â”‚
â””â”€â”€ README.md                     # This file
```

---

## ğŸ’» YÃªu cáº§u há»‡ thá»‘ng

### Pháº§n má»m báº¯t buá»™c:

- **Node.js**: >= 16.x (Khuyáº¿n nghá»‹ 18.x)
- **npm**: >= 8.x
- **MongoDB**: Local hoáº·c MongoDB Atlas (Cloud)
- **Git**: Version control
- **MetaMask**: Browser extension (Chrome/Brave/Firefox) **âš ï¸ Báº®T BUá»˜C**

### TÃ i khoáº£n cáº§n cÃ³:

1. **MongoDB Atlas** (miá»…n phÃ­):
   - ÄÄƒng kÃ½ táº¡i: https://www.mongodb.com/cloud/atlas/register
   - Táº¡o cluster (M0 Free tier)
   - Láº¥y connection string

2. **Alchemy** (miá»…n phÃ­):
   - ÄÄƒng kÃ½ táº¡i: https://www.alchemy.com/
   - Táº¡o app cho Sepolia network
   - Láº¥y API key vÃ  RPC URL

3. **MetaMask Wallet**:
   - CÃ i extension: https://metamask.io/download/
   - Táº¡o hoáº·c import wallet
   - **Láº¥y Sepolia ETH** tá»« faucet (miá»…n phÃ­)

### Sepolia Test ETH (Miá»…n phÃ­):

Cáº§n ~0.1 Sepolia ETH Ä‘á»ƒ test. Láº¥y tá»« cÃ¡c faucet sau:

- ğŸš° Alchemy Faucet: https://www.alchemy.com/faucets/ethereum-sepolia
- ğŸš° Sepolia Faucet: https://sepoliafaucet.com/
- ğŸš° PoW Faucet: https://sepolia-faucet.pk910.de/

---

## ğŸš€ CÃ i Ä‘áº·t nhanh

### âš¡ Quick Start (5 phÃºt):

```bash
# 1. Clone repository
git clone https://github.com/linhnguyen0702/QuanLyHopDongCongBlockchain.git
cd QuanLyHopDongCong

# 2. Setup Backend
cd backend
npm install
copy config.env.example config.env
# âš ï¸ Sá»­a config.env vá»›i thÃ´ng tin cá»§a báº¡n
npm run seed

# 3. Setup Frontend (terminal má»›i)
cd ../frontend
npm install

# 4. Start All (terminal 1: backend, terminal 2: frontend)
# Backend:
cd backend && npm run dev
# Frontend (terminal má»›i):
cd frontend && npm start

# 5. Truy cáº­p: http://localhost:3000
# Login: admin@gov.vn / admin123
```

---

## ğŸ“– HÆ°á»›ng dáº«n chi tiáº¿t
â”‚   â”œâ”€â”€ contracts/
â”‚   â”‚   â””â”€â”€ ContractManager.sol   # Smart contract
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ deploy.js             # Deploy script
â”‚   â”‚   â””â”€â”€ check-balance.js
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â””â”€â”€ ContractManager.test.js
â”‚   â”œâ”€â”€ abi/                      # Compiled ABIs
â”‚   â”œâ”€â”€ hardhat.config.js
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ README.md                     # This file
â”œâ”€â”€ README_BLOCKCHAIN.md          # Blockchain docs
â””â”€â”€ BLOCKCHAIN_SETUP.md          # Setup guide
```

---

## ğŸ’» YÃªu cáº§u há»‡ thá»‘ng

### Pháº§n má»m:

- **Node.js**: >= 16.x
- **npm**: >= 8.x (hoáº·c yarn)
- **MongoDB**: Local hoáº·c MongoDB Atlas
- **Git**: Äá»ƒ clone repository
- **MetaMask**: Browser extension

### TÃ i khoáº£n cáº§n cÃ³:

- MongoDB Atlas account (miá»…n phÃ­)
- Alchemy account (Ä‘á»ƒ RPC URL)
- MetaMask wallet vá»›i Sepolia ETH

---

## ğŸš€ CÃ i Ä‘áº·t vÃ  Cháº¡y dá»± Ã¡n

### Láº§n Ä‘áº§u tiÃªn (First Time Setup):

#### 1ï¸âƒ£ Clone Repository

```bash
git clone https://github.com/linhnguyen0702/QuanLyHopDongCongBlockchain.git
cd QuanLyHopDongCong
```

#### 2ï¸âƒ£ CÃ i Ä‘áº·t Backend

```bash
cd backend
npm install
```

**Táº¡o file `config.env`:**

```bash
copy config.env.example config.env
```

**Cáº­p nháº­t `config.env`:**

```env
PORT=5000
NODE_ENV=development

JWT_SECRET=your-super-secret-jwt-key-here
JWT_EXPIRE=7d

# MongoDB (sá»­ dá»¥ng MongoDB Atlas hoáº·c local)
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/database_name

# Blockchain
BLOCKCHAIN_ENABLED=true
BLOCKCHAIN_NETWORK=sepolia
BLOCKCHAIN_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/YOUR_API_KEY
BLOCKCHAIN_CONTRACT_ADDRESS=0x73fdfbb38c4a6a652306c898a99613df79624353
BLOCKCHAIN_PRIVATE_KEY=your_private_key_without_0x
```

**Seed dá»¯ liá»‡u máº«u:**

```bash
npm run seed
```

#### 3ï¸âƒ£ CÃ i Ä‘áº·t Frontend

```bash
cd ../frontend
npm install
```

#### 4ï¸âƒ£ Blockchain Module (KHÃ”NG Cáº¦N CHáº Y)

âš ï¸ **LÆ¯U Ã**: Smart contract Ä‘Ã£ Ä‘Æ°á»£c deploy lÃªn Sepolia rá»“i!

- âœ… Contract address: `0x73fdfbb38c4a6a652306c898a99613df79624353`
- âœ… Báº¡n KHÃ”NG Cáº¦N cháº¡y `blockchain/` module
- âœ… Chá»‰ cáº§n cáº¥u hÃ¬nh `BLOCKCHAIN_CONTRACT_ADDRESS` trong `config.env`

**Chá»‰ cÃ i Ä‘áº·t náº¿u muá»‘n deploy contract má»›i:**

```bash
cd ../blockchain
npm install
# Xem BLOCKCHAIN_SETUP.md Ä‘á»ƒ biáº¿t chi tiáº¿t
```

---

### ğŸ”„ Cháº¡y dá»± Ã¡n (Má»—i láº§n sau):

**Chá»‰ cáº§n má»Ÿ 2 terminals:**

#### âš¡ CÃ¡ch nhanh nháº¥t:

```bash
# Double-click vÃ o file:
start-all.bat
```

#### ğŸ”§ Hoáº·c cháº¡y thá»§ cÃ´ng:

**Terminal 1ï¸âƒ£: Backend**

```bash
cd backend
npm run dev
```

**âœ… Chá» Ä‘áº¿n khi tháº¥y:**

```
ğŸš€ Server running on port 5000
âœ… MongoDB connected successfully
âœ… Blockchain service initialized successfully
```

**Terminal 2ï¸âƒ£: Frontend**

```bash
cd frontend
npm start
```

**âœ… Chá» Ä‘áº¿n khi tháº¥y:**

```
Compiled successfully!
Local: http://localhost:3000
```

âš ï¸ **LÆ¯U Ã**: KHÃ”NG Cáº¦N cháº¡y `blockchain/` module vÃ¬ smart contract Ä‘Ã£ Ä‘Æ°á»£c deploy lÃªn Sepolia rá»“i!

---

## ğŸ“± Truy cáº­p á»©ng dá»¥ng

### Frontend:

```
http://localhost:3000
```

**TÃ i khoáº£n máº·c Ä‘á»‹nh:**

- **Admin**: admin@example.com / /password123
- **Manager**: `manager@gov.vn` / `manager123`
- **Employee**: `user@gov.vn` / `user123`

### Backend API:

```
http://localhost:5000/api
```

### Blockchain Explorer:

```
https://sepolia.etherscan.io/address/0x73fdfbb38c4a6a652306c898a99613df79624353
```

---

## ğŸ¨ TÃ­nh nÄƒng

### 1. Quáº£n lÃ½ Há»£p Ä‘á»“ng

- Táº¡o, sá»­a, xÃ³a há»£p Ä‘á»“ng
- TÃ¬m kiáº¿m vÃ  lá»c
- PhÃ¢n loáº¡i theo tráº¡ng thÃ¡i
- Upload tÃ i liá»‡u Ä‘Ã­nh kÃ¨m
- **Ghi lÃªn blockchain tá»± Ä‘á»™ng**

### 2. Blockchain Integration

- âœ… Má»—i há»£p Ä‘á»“ng Ä‘Æ°á»£c ghi lÃªn Ethereum Sepolia
- âœ… Transaction hash cÃ³ thá»ƒ xem trÃªn Etherscan
- âœ… KhÃ´ng thá»ƒ sá»­a Ä‘á»•i sau khi ghi
- âœ… Lá»‹ch sá»­ thay Ä‘á»•i báº¥t biáº¿n

### 3. MetaMask Integration

- Káº¿t ná»‘i vÃ­ MetaMask
- Hiá»ƒn thá»‹ Ä‘á»‹a chá»‰ vÃ  balance
- Tá»± Ä‘á»™ng phÃ¡t hiá»‡n network sai
- Switch sang Sepolia tá»± Ä‘á»™ng

### 4. PhÃª duyá»‡t Há»£p Ä‘á»“ng

- Workflow phÃª duyá»‡t
- Lá»‹ch sá»­ phÃª duyá»‡t
- Ghi lÃªn blockchain khi approve

### 5. BÃ¡o cÃ¡o & Thá»‘ng kÃª

- Dashboard tá»•ng quan
- Biá»ƒu Ä‘á»“ thá»‘ng kÃª
- Export bÃ¡o cÃ¡o

### 6. Audit Trail

- LÆ°u láº¡i má»i thay Ä‘á»•i
- Xem lá»‹ch sá»­ chi tiáº¿t
- KhÃ´ng thá»ƒ xÃ³a logs

---

## ğŸ”— Blockchain Integration

### Smart Contract Address (Sepolia):

```
0x73fdfbb38c4a6a652306c898a99613df79624353
```

### CÃ¡ch hoáº¡t Ä‘á»™ng:

1. **Táº¡o há»£p Ä‘á»“ng má»›i:**

   - LÆ°u vÃ o MongoDB
   - Tráº£ response cho frontend ngay (< 1s)
   - Ghi lÃªn blockchain á»Ÿ background (15-30s)
   - Update transaction hash sau khi confirm

2. **Xem trÃªn Etherscan:**

   - Click vÃ o transaction hash trong chi tiáº¿t há»£p Ä‘á»“ng
   - Hoáº·c truy cáº­p: `https://sepolia.etherscan.io/tx/{transaction_hash}`

3. **Láº¥y Sepolia ETH (cho testing):**
   - https://www.alchemy.com/faucets/ethereum-sepolia
   - https://sepoliafaucet.com/
   - https://sepolia-faucet.pk910.de/

### MetaMask Setup:

1. **CÃ i Ä‘áº·t MetaMask:** https://metamask.io/download/
2. **ThÃªm Sepolia Network:**
   - Network Name: `Sepolia Test Network`
   - RPC URL: `https://sepolia.infura.io/v3/`
   - Chain ID: `11155111`
   - Currency: `ETH`
   - Explorer: `https://sepolia.etherscan.io`
3. **Láº¥y test ETH** tá»« faucet (link á»Ÿ trÃªn)
4. **Káº¿t ná»‘i wallet** trÃªn trang web

---

## ğŸ“š API Documentation

### Base URL:

```
http://localhost:5000/api
```

### Authentication:

ThÃªm header:

```
Authorization: Bearer {jwt_token}
```

### Main Endpoints:

#### Auth:

- `POST /auth/login` - Login
- `GET /auth/profile` - Get profile

#### Contracts:

- `GET /contracts` - List contracts
- `GET /contracts/:id` - Get contract detail
- `POST /contracts` - Create contract (â†’ ghi blockchain)
- `PUT /contracts/:id` - Update contract (â†’ ghi blockchain)
- `DELETE /contracts/:id` - Delete contract

#### Contractors:

- `GET /contractors` - List contractors
- `POST /contractors` - Create contractor

#### Users:

- `GET /users` - List users
- `POST /users` - Create user

#### Reports:

- `GET /reports/overview` - Dashboard stats
- `GET /reports/contracts-by-status` - Statistics

---

## ğŸ”§ Troubleshooting

### Backend khÃ´ng cháº¡y Ä‘Æ°á»£c:

**Lá»—i: MongoDB connection failed**

```bash
# Kiá»ƒm tra MongoDB URI trong config.env
# Äáº£m báº£o MongoDB Ä‘ang cháº¡y (náº¿u dÃ¹ng local)
# Hoáº·c kiá»ƒm tra connection string cá»§a MongoDB Atlas
```

**Lá»—i: Port 5000 already in use**

```bash
# TÃ¬m vÃ  kill process Ä‘ang dÃ¹ng port 5000
netstat -ano | findstr :5000
taskkill /PID <PID> /F

# Hoáº·c Ä‘á»•i PORT trong config.env
PORT=5001
```

### Frontend khÃ´ng cháº¡y Ä‘Æ°á»£c:

**Lá»—i: Port 3000 already in use**

```bash
# Kill process hoáº·c chá»n port khÃ¡c khi Ä‘Æ°á»£c há»i
Would you like to run the app on another port instead? (Y/n)
# Chá»n Y
```

### Blockchain khÃ´ng hoáº¡t Ä‘á»™ng:

**Lá»—i: Blockchain service initialization failed**

```bash
# Kiá»ƒm tra config.env:
# 1. BLOCKCHAIN_RPC_URL Ä‘Ãºng chÆ°a?
# 2. BLOCKCHAIN_CONTRACT_ADDRESS Ä‘Ãºng chÆ°a?
# 3. BLOCKCHAIN_PRIVATE_KEY Ä‘Ãºng chÆ°a?

# Restart backend sau khi sá»­a
```

**Lá»—i: Transaction timeout**

```bash
# BÃ¬nh thÆ°á»ng! Transaction blockchain máº¥t 15-30 giÃ¢y
# Há»‡ thá»‘ng Ä‘Ã£ Ä‘Æ°á»£c config Ä‘á»ƒ:
# - Tráº£ response ngay
# - Ghi blockchain á»Ÿ background
# - Refresh trang sau 30s Ä‘á»ƒ tháº¥y transaction hash
```

**KhÃ´ng cÃ³ ETH trong Sepolia:**

```bash
# Láº¥y test ETH tá»« faucet:
# 1. Copy Ä‘á»‹a chá»‰ vÃ­ tá»« MetaMask
# 2. VÃ o: https://www.alchemy.com/faucets/ethereum-sepolia
# 3. Paste Ä‘á»‹a chá»‰ vÃ  request ETH
# 4. Äá»£i 1-2 phÃºt
```

---

## ğŸ” Báº£o máº­t

### âš ï¸ QUAN TRá»ŒNG:

1. **KHÃ”NG commit `config.env`** lÃªn Git
2. **KHÃ”NG share private key** cá»§a vÃ­
3. **KHÃ”NG dÃ¹ng private key cÃ³ tiá»n tháº­t** cho testing
4. **JWT_SECRET** pháº£i lÃ  chuá»—i random máº¡nh

### Best Practices:

- Äá»•i password máº·c Ä‘á»‹nh sau khi deploy
- Sá»­ dá»¥ng HTTPS trong production
- Rate limiting Ä‘Ã£ Ä‘Æ°á»£c enable
- Input validation Ä‘Ã£ Ä‘Æ°á»£c implement

---

## ğŸ“ Scripts há»¯u Ã­ch

### Backend:

```bash
npm run dev         # Cháº¡y development mode
npm start          # Cháº¡y production mode
npm run seed       # Seed dá»¯ liá»‡u máº«u
npm run clear      # XÃ³a toÃ n bá»™ database
```

### Frontend:

```bash
npm start          # Cháº¡y development
npm run build      # Build production
npm test           # Cháº¡y tests
```

### Blockchain:

```bash
npx hardhat compile              # Compile contracts
npx hardhat test                 # Run tests
npx hardhat node                 # Start local node
npx hardhat run scripts/deploy.js --network sepolia  # Deploy
```

---

## ğŸ“ LiÃªn há»‡ & Há»— trá»£

- **GitHub**: https://github.com/linhnguyen0702/QuanLyHopDongCongBlockchain
- **Issues**: https://github.com/linhnguyen0702/QuanLyHopDongCongBlockchain/issues

---

## ğŸ“„ License

MIT License - Xem file `LICENSE` Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t.

---

## ğŸ‰ Báº¯t Ä‘áº§u nhanh (Quick Start)

```bash
# Clone repository
git clone https://github.com/linhnguyen0702/QuanLyHopDongCongBlockchain.git
cd QuanLyHopDongCong

# Setup Backend
cd backend
npm install
copy config.env.example config.env
# Cáº­p nháº­t config.env vá»›i thÃ´ng tin cá»§a báº¡n
npm run seed
npm run dev

# Setup Frontend (terminal má»›i)
cd frontend
npm install
npm start

# Truy cáº­p: http://localhost:3000
# Login: admin@gov.vn / admin123
```

---

## ğŸŒŸ TÃ­nh nÄƒng ná»•i báº­t

### â›“ï¸ Blockchain Integration:

- Má»—i há»£p Ä‘á»“ng Ä‘Æ°á»£c ghi lÃªn Ethereum Sepolia
- Transaction khÃ´ng thá»ƒ thay Ä‘á»•i sau khi confirm
- CÃ³ thá»ƒ verify trÃªn Etherscan
- Tá»± Ä‘á»™ng sync á»Ÿ background (khÃ´ng lÃ m cháº­m UX)

### ğŸ”’ Báº£o máº­t:

- JWT authentication
- Role-based access control (Admin, Manager, Employee)
- Password hashing with bcrypt
- Input validation
- Rate limiting

### ğŸ“Š Dashboard & Reports:

- Tá»•ng quan há»£p Ä‘á»“ng
- Biá»ƒu Ä‘á»“ thá»‘ng kÃª
- Filter vÃ  search nÃ¢ng cao
- Export data

---

**âœ¨ ChÃºc báº¡n phÃ¡t triá»ƒn thÃ nh cÃ´ng! âœ¨**
